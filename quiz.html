<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>六年級數學測驗</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; background: #f0f8ff; text-align: center; padding: 2rem; }
    .unit-button, .option, .nav-button {
      display: block;
      margin: 1rem auto;
      padding: 1rem;
      width: 80%;
      max-width: 300px;
      font-size: 1.2rem;
      border: 1px solid #4a90e2;
      border-radius: 8px;
      background: white;
      color: #4a90e2;
      cursor: pointer;
    }
    .unit-button:hover, .nav-button:hover { background: #4a90e2; color: white; }
    .hidden { display: none; }
  </style>
</head>
<body>

<h1>🎯 選擇要測驗的單元</h1>

<div id="unit-selection">
  <button class="unit-button" onclick="startQuiz('分數與小數')">分數與小數</button>
  <button class="unit-button" onclick="startQuiz('百分比')">百分比</button>
  <button class="unit-button" onclick="startQuiz('面積公式')">面積公式</button>
  <button class="unit-button" onclick="startQuiz('圓形公式')">圓形公式</button>
  <button class="unit-button" onclick="startQuiz('比例')">比例</button>
  <button class="unit-button" onclick="startQuiz('資料統計')">資料統計</button>
</div>

<div id="quiz" class="hidden">
  <h2 id="question-text"></h2>
  <div id="options"></div>
  <div id="result" style="margin:1rem;font-weight:bold;"></div>
  <p>得分：<span id="score">0</span> / <span id="total">0</span></p>
  <button class="nav-button" onclick="nextQuestion()">下一題</button>
  <button class="nav-button" onclick="restart()">重新選單元</button>
</div>

<script>
const allQuestions = {
  "分數與小數": [
    { q: "1/2變成小數是多少？", options: ["0.5", "0.25", "0.75"], answer: "0.5" },
    { q: "1/4變成小數是多少？", options: ["0.25", "0.5", "0.75"], answer: "0.25" },
    { q: "3/4變成小數是多少？", options: ["0.75", "0.5", "1.0"], answer: "0.75" },
    { q: "2/5變成小數是多少？", options: ["0.4", "0.5", "0.8"], answer: "0.4" },
    { q: "4/5變成小數是多少？", options: ["0.8", "0.5", "0.75"], answer: "0.8" },
    { q: "1/5變成小數是多少？", options: ["0.2", "0.5", "0.8"], answer: "0.2" },
    { q: "3/5變成小數是多少？", options: ["0.6", "0.5", "0.8"], answer: "0.6" }
  ],
  "百分比": [
    { q: "50%變成小數是多少？", options: ["0.25", "0.5", "0.75"], answer: "0.5" },
    { q: "25%變成小數是多少？", options: ["0.25", "0.4", "0.6"], answer: "0.25" },
    { q: "10%變成小數是多少？", options: ["0.1", "0.01", "0.5"], answer: "0.1" },
    { q: "75%變成小數是多少？", options: ["0.5", "0.75", "1.0"], answer: "0.75" },
    { q: "5%變成小數是多少？", options: ["0.05", "0.5", "0.25"], answer: "0.05" },
    { q: "100%是小數多少？", options: ["1", "0.5", "2"], answer: "1" }
  ],
  "面積公式": [
    { q: "長方形的面積公式是？", options: ["長×寬", "長+寬", "邊長×邊長"], answer: "長×寬" },
    { q: "正方形的面積公式是？", options: ["邊長×邊長", "底×高", "底×高÷2"], answer: "邊長×邊長" },
    { q: "三角形的面積公式是？", options: ["底×高÷2", "底×高", "邊長×邊長"], answer: "底×高÷2" },
    { q: "平行四邊形的面積公式是？", options: ["底×高", "長×寬", "邊長×邊長"], answer: "底×高" },
    { q: "梯形的面積公式是？", options: ["(上底+下底)×高÷2", "底×高÷2", "邊長×邊長"], answer: "(上底+下底)×高÷2" }
  ],
  "圓形公式": [
    { q: "圓的面積公式是？", options: ["半徑×半徑×3.14", "半徑×2", "直徑×2"], answer: "半徑×半徑×3.14" },
    { q: "圓的周長公式是？", options: ["直徑×3.14", "半徑×3.14", "半徑+半徑"], answer: "直徑×3.14" },
    { q: "直徑是半徑的幾倍？", options: ["2倍", "3倍", "1倍"], answer: "2倍" },
    { q: "半徑是直徑的幾分之幾？", options: ["二分之一", "三分之一", "四分之一"], answer: "二分之一" },
    { q: "半徑5公分，圓面積約是多少？", options: ["78.5平方公分", "25平方公分", "31.4平方公分"], answer: "78.5平方公分" }
  ],
  "比例": [
    { q: "2:3放大2倍是多少？", options: ["4:6", "2:3", "6:9"], answer: "4:6" },
    { q: "6:9簡化後是多少？", options: ["2:3", "3:5", "1:2"], answer: "2:3" },
    { q: "4:8簡化後是多少？", options: ["1:2", "2:3", "2:1"], answer: "1:2" },
    { q: "8:4簡化後是多少？", options: ["2:1", "1:2", "4:8"], answer: "2:1" },
    { q: "3:6=？:2", options: ["1", "2", "3"], answer: "1" }
  ],
  "資料統計": [
    { q: "長條圖適合看什麼？", options: ["比較數量", "看時間變化", "看比例"], answer: "比較數量" },
    { q: "圓餅圖適合看什麼？", options: ["看比例", "看高低", "看時間"], answer: "看比例" },
    { q: "折線圖適合看什麼？", options: ["看變化趨勢", "看比例", "看數量"], answer: "看變化趨勢" },
    { q: "統計圖表可以讓我們？", options: ["更清楚資料", "數字變多", "顏色變少"], answer: "更清楚資料" },
    { q: "什麼圖適合看整體中各部分比例？", options: ["圓餅圖", "長條圖", "折線圖"], answer: "圓餅圖" }
  ]
};

let selectedQuestions = [];
let currentIndex = 0;
let score = 0;
let hasAnswered = false;

function startQuiz(unit) {
  document.getElementById("unit-selection").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  selectedQuestions = shuffleArray([...allQuestions[unit]]).slice(0, 15);
  currentIndex = 0;
  score = 0;
  document.getElementById("score").textContent = score;
  document.getElementById("total").textContent = selectedQuestions.length;
  showQuestion();
}

function showQuestion() {
  const q = selectedQuestions[currentIndex];
  document.getElementById("question-text").textContent = q.q;
  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";
  document.getElementById("result").textContent = "";
  hasAnswered = false;

  shuffleArray(q.options).forEach(opt => {
    const btn = document.createElement("button");
    btn.className = "option";
    btn.textContent = opt;
    btn.onclick = () => checkAnswer(btn, opt, q.answer);
    optionsDiv.appendChild(btn);
  });
}

function checkAnswer(button, choice, correct) {
  if (hasAnswered) return;
  hasAnswered = true;
  const result = document.getElementById("result");
  const allOptions = document.querySelectorAll(".option");
  allOptions.forEach(btn => btn.disabled = true);

  if (choice === correct) {
    score++;
    document.getElementById("score").textContent = score;
    result.textContent = "✅ 答對了！";
    result.style.color = "green";
  } else {
    result.innerHTML = `❌ 錯了！<br>正確答案是：<b>${correct}</b>`;
    result.style.color = "red";
  }
}

function nextQuestion() {
  if (!hasAnswered) return alert("請先作答！");
  currentIndex++;
  if (currentIndex < selectedQuestions.length) {
    showQuestion();
  } else {
    let message = score >= selectedQuestions.length * 0.8 ? "🎉 很棒喔！" : "💪 加油，下次更好！";
    alert("測驗結束！得分：" + score + "/" + selectedQuestions.length + "\\n" + message);
    restart();
  }
}

function restart() {
  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("unit-selection").classList.remove("hidden");
}

function shuffleArray(array) {
  return array.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>
